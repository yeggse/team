<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.mapper.ResmenuMapper">	
	<select id="selectResmenu" parameterType="hashmap" resultType="com.example.demo.model.Res">	
		SELECT
			r.idx, reskind, startdate, enddate, menuname, introduce, price, supply, orderer, pickuptime, resnum, picture, 0 as sum <!-- 컬럼을 임의로 추가해서 계산 할 수 있게 만든거임! SQL에는 실제로 추가 된건 아님! -->
		FROM
			t3_resmenu r
		<!-- WHERE resnum = #{resnum} -->
		LEFT OUTER JOIN t3_resmenu_img i on r.idx = i.idx 
		WHERE
			r.idx = #{idx} OR resnum = #{resnum}
	</select>
	
<!-- group by 컬럼명 -->

	<select id="selectResmenu1" parameterType="hashmap" resultType="com.example.demo.model.Res">	
		SELECT
			ordernum,menuname,pickuptime,payment,price, idx
			reskind, startdate,enddate,picture,introduce,supply,orderer,resnum
		FROM
			t3_reserve
		WHERE orderer = #{id}
		
	</select>
	
	<select id="selectPaymentmy1" parameterType="hashmap" resultType="com.example.demo.model.Res">	
		SELECT
			ordernum, menuname, price, resnum
		FROM
			t3_reserve
		WHERE
		 	orderer = #{id} AND salecomple = "Y"
	</select>
	
	<!-- 사업자 메뉴관리 페이지 게시물 갯수 -->
	<select id="selectResmenuCnt" resultType="int">	
		SELECT 
			COUNT(*) AS CNT
		FROM
			t3_resmenu
	</select>
	
	
	
	<!-- picture join -->
<!-- 	<select id="selectImg" parameterType="hashmap" resultType="com.example.demo.model.Res">	
			SELECT
				picture
			FROM
				t3_resmenu_img
			INNER JOIN 
				t3_resmenu
			ON 
				t3_restaurant.picture = t3_resmenu.picture
			WHERE 
				t3_restaurant.idx =2;  하드코딩 고치기
	</select> -->
	
	<!-- picture print(storeList_Clicked) -->
	<!-- <select id="selectStorecliectedImg" resultType="com.example.demo.model.Res">	
			SELECT
				r.idx, picture
			FROM
			t3_resmenu r
			
		LEFT OUTER JOIN t3_resmenu_img i on r.idx = i.idx 
		WHERE
			r.idx = #{idx}
	</select>	
	 -->
	
	
	
	
	
	<!-- id join -->
<!-- 	<select id="selectResmenu3" parameterType="hashmap" resultType="com.example.demo.model.Res">	
			SELECT
				*
			FROM
				t3_account
			INNER JOIN 
				t3_resmenu
			ON 
				t3_account.resnum = t3_resmenu.resnum
			WHERE 
				t3_account.resnum = #{resnum}  하드코딩 고치기
	</select> -->
	
	<!-- resnum join -->
	<select id="selectResmenu2" parameterType="hashmap" resultType="com.example.demo.model.Res">	
			SELECT
				*
			FROM
				t3_restaurant
			INNER JOIN 
				t3_resmenu
			ON 
				t3_restaurant.resnum = t3_resmenu.resnum
			WHERE 
				t3_restaurant.resnum = #{resnum}  <!-- 하드코딩 고치기 -->
	</select>
	
	<select id="searchMenuname" parameterType="hashmap" resultType="com.example.demo.model.Res">	
			SELECT
				*
			FROM
				t3_resmenu
			WHERE 
				menuname = #{menuname} 
	</select>
	
	<insert id="insertreserve" parameterType="hashmap">
		INSERT INTO 
		t3_reserve(resnum,menuname,ordernum,
		orderer,pickuptime,payment,price,review,
		salecomple,menunum)

		VALUES(
		
		#{resnum}
		,#{menuname}
		,#{ordernum}
		,#{orderer}
		,#{pickuptime}
		,#{payment}
		,#{price}
		,#{review}
		,#{salecomple}
		,#{menunum}
		)
		
	</insert>
	<select id="businessReserveList" parameterType="hashmap" resultType="com.example.demo.model.Res">	
			SELECT 
				resnum, ordernum, menuname, orderer, pickuptime, payment, price, review, salecomple, no, orderdate, menunum
			FROM
				t3_reserve
			where resnum = #{resnum}
			ORDER BY orderdate DESC
			
			
	</select>	

</mapper>